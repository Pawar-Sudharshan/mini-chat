<!-- views/index.ejs - Main Chat Display Page -->
<!-- This page shows all chat messages in a responsive Bootstrap layout -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />                                          <!-- Set character encoding -->
    <meta name="viewport" content="width=device-width, initial-scale=1" /> <!-- Make page responsive -->
    <title>mini chatBox</title>                                       <!-- Page title shown in browser tab -->

    <!-- Bootstrap CSS CDN - Version 5.3.8 for modern styling -->
    <!-- This provides pre-built CSS classes for responsive design and components -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    
    <!-- Optional: Custom CSS file (commented out) -->
    <!-- <link rel="stylesheet" href="/css/style.css" /> -->
</head>

<body>
    <!-- Main container with Bootstrap classes -->
    <div class="container my-4">                                      <!-- Container with margin top/bottom -->
        <h1 class="mb-4">All Chats</h1>                              <!-- Main heading with margin bottom -->
        
        <!-- Form to navigate to new chat creation page -->
        <form method="GET" action="/chats/new">                       <!-- GET request to show new chat form -->
            <button type="submit" class="btn btn-primary">New Chat</button> <!-- Bootstrap primary button -->
        </form>

        <!-- Bootstrap grid system for responsive chat cards -->
        <div class="row g-4">                                         <!-- Row with gap between columns -->
            
            <!-- EJS loop to display each chat message -->
            <% for (let chat of chats) { %>                           <!-- Loop through all chats from database -->
                <div class="col-4 d-flex align-items-stretch">       <!-- 4 columns per row, equal height cards -->
                    
                    <!-- Bootstrap card component for each chat -->
                    <div class="card shadow-sm w-100">               <!-- Card with shadow and full width -->
                        <div class="card-body">                      <!-- Card body containing chat information -->
                            
                            <!-- Display sender name -->
                            <h5 class="card-title text-primary">Sender: <%= chat.from %></h5>
                            
                            <!-- Display message content -->
                            <p class="card-text"><strong>Message:</strong> <%= chat.message %></p>
                            
                            <!-- Display receiver name -->
                            <p class="card-text"><strong>To:</strong> <%= chat.to %></p>
                            
                            <!-- Display formatted creation timestamp -->
                            <p class="card-text text-muted">
                                <small>Created at: <%= new Date(chat.created_at).toLocaleString() %></small>
                            </p>

                        </div>
                        
                        <!-- Edit button form -->
                        <!-- GET request to show edit form for this specific chat -->
                        <form action="/chats/<%= chat._id %>/edit" method="GET">
                            <button type="submit" class="btn btn-primary">edit</button> <!-- Bootstrap edit button -->
                        </form>
                        
                        <br><br>                                     <!-- Add some spacing -->
                        
                        <!-- Delete button form -->
                        <!-- POST request with method override to delete this chat -->
                        <form action="/chats/<%= chat._id %>?_method=DELETE" method="POST">
                            <button type="submit" class="btn btn-danger">delete</button> <!-- Bootstrap danger button -->
                        </form>

                    </div> <!-- End of card -->
                </div> <!-- End of column -->
            <% } %>                                                  <!-- End of EJS loop -->
        </div> <!-- End of row -->
    </div> <!-- End of container -->

    <!-- Bootstrap JavaScript Bundle -->
    <!-- This enables Bootstrap's interactive components like modals, dropdowns, etc. -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
</body>

</html>